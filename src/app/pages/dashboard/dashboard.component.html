<div class="header pb-8 pt-5 pt-md-8 pt-lg-8 d-flex align-items-center" style="min-height: 300px; background-image: url(assets/img/new.jpg); background-size: cover; background-position: center top;">
  <span class="mask bg-gradient-danger opacity-8"></span></div>
<div class="container-fluid mt--7">
  <div class="row">
    <div class="col-xl-8 mb-5 mb-xl-0">
      <perfect-scrollbar class="card bg-gradient-default shadow scroll-disable">
        <div class="card-header bg-transparent">
          <div class="row align-items-center">
            <div class="col">
              <h2 class="text-white mb-0">Activities</h2>
            </div>
            <div class="col">
              <ul class="nav nav-pills justify-content-end">
                <li class="nav-item mr-2 mr-md-0" data-toggle="chart" data-target="#chart-sales">
                  <a href="javascript:void(0)" class="nav-link py-2 px-3" data-toggle="tab">
                    <span class="d-none d-md-block">Month</span>
                    <span class="d-md-none">M</span>
                  </a>
                </li>
                <li class="nav-item" data-toggle="chart" data-target="#chart-sales">
                  <a href="javascript:void(0)" class="nav-link py-2 px-3" data-toggle="tab">
                    <span class="d-none d-md-block">Week</span>
                    <span class="d-md-none">W</span>
                  </a>
                </li>
              </ul>
            </div>
          </div>
        </div>
        <div class="card-body card-padding">
          <!-- Chart -->
          <div class="chart ">
            <div class="col-xl-8 order-xl-1 card-fit ">
              <div *ngFor = "let activities of activitieslist; let i=index ">
                <div id = "{{activities.group}}{{i}}">
                <h2 class="text-white mb-0 tag-inline">{{activities.date}}</h2>
                <span (click) = "expandChild(i)"class="badge expand-color" *ngIf="activities.group == 'parent'">Expand</span>
                <span class="badge holiday-color" *ngIf="activities.holiday == true">Holiday</span>
                  <div *ngFor = "let activity of activities.activities; let j = index" class="">
                    <div class="card-body card-padding margin-fields">
                      <form class="form-height" [formGroup]= "updateActivityForm">
                        <div class="dashboard-activity-margin">
                          <div class="row">
                            <div class="col-lg-3 dashboard-activity-padding">
                              <div class="form-group">
                                  <select class="project-dropdown" formControlName = "project" id = "input-project{{i}}{{j}}">
                                      <option value="" selected >{{activity.project}}</option>
                                      <option *ngFor = "let project of projectsList" [value]="project.id" [selected]="project.id === activity.id" >{{project.name}}</option>
                                  </select>
                              </div>
                            </div>
                            <div class="col-lg-5 dashboard-activity-padding">
                              <div class="form-group">
                                <input type="text" id="input-activity{{i}}{{j}}" class="form-control form-control-alternative black" (keyup.enter)="updateActivity(activities.date, activity.id,i,j)" placeholder="Activity" [value] = "activity.activity" formControlName = "activity">
                              </div>
                            </div>
                            <div class="col-lg-2 dashboard-activity-padding">
                              <div class="form-group">
                                <input type="text" id="input-hours{{i}}{{j}}" class="form-control form-control-alternative black" (keyup.enter)="updateActivity(activities.date, activity.id,i,j)" placeholder="Hours" [value] = "activity.hours" formControlName = "hours">
                              </div>
                            </div>
                            <div id = "editbutton{{i}}{{j}}" style="display: block;">
                              <a (click) = "enableFields(i,j)" style="cursor: pointer;"><i class='fas fa-edit icon-style' style="color:  #33ccff"></i> </a>
                            </div>
                            <div id ="savebutton{{i}}{{j}}" style="display: none;">
                              <a (click)="updateActivity(activities.date, activity.id,i,j)" style="cursor:pointer ;"><i class='fas fa-check icon-style' style="color:  #40ff00"></i></a>
                            </div>
                            <div>
                              <a (click)="removeActivity(activity.id)" style="cursor:pointer ;"><i class='fas fa-trash icon-style' style="color:  #ff0000"></i></a>
                            </div>
                          </div>
                        </div>
                      </form>
                    </div>
                  </div>
                  <div class="">
                    <div class="card-body card-padding margin-fields" *ngFor = "let container of activities.containers; let j = index">
                      <form class="form-height" [formGroup] ="activityForm">
                        <div class="dashboard-activity-margin">
                          <div class="row">
                            <div class="col-lg-3 dashboard-activity-padding">
                                <select id="project{{i}}{{j}}"class="project-dropdown" formControlName = "project" placeholder="Select Project">
                                    <option value="" disabled selected hidden>Select Project</option>
                                    <option *ngFor = "let project of projectsList" [value]="project.id">{{project.name}}</option>
                                </select>
                            </div>
                            <div class="col-lg-5 dashboard-activity-padding">
                              <div class="form-group">
                                <input type="text" id="input-activity" class="form-control form-control-alternative" style = "color: black;"placeholder="Activity" formControlName = "activity">
                                  </div>
                              </div>
                            <div class="col-lg-2 dashboard-activity-padding">
                              <div class="form-group">
                                <input type="text" id="input-hours" class="form-control form-control-alternative" style = "color: black;" placeholder="Hours" formControlName = "hours">
                              </div>
                            </div>
                            <div class="button-margin">
                              <button class="btn btn-success" (click) = "createActivity(activities.date)">Save</button>
                            </div>
                          </div>
                        </div>
                      </form>
                    </div>
                  </div>
                </div>
                <div id ="child{{i}}" style="display: none;">
                  <div *ngFor = "let children of activities.children; let k = index">
                  <h2 class="text-white mb-0 tag-inline">{{children.date}}</h2>
                  <span class="badge expand-color" *ngIf="children.group == 'parent'">Expand</span>
                  <span class="badge holiday-color" *ngIf="children.holiday == true">Holiday</span>
                    <div *ngFor = "let childactivity of children.activities" class="">
                      <div class="card-body card-padding margin-fields">
                        <form class="form-height" [formGroup] = "childUpdateActivityForm" >
                          <div class="dashboard-activity-margin">
                            <div class="row">
                              <div class="col-lg-3 dashboard-activity-padding">
                                <div class="form-group">
                                    <select class="project-dropdown" formControlName = "project" id = "input-project{{i}}{{j}}">
                                        <option value="" selected >{{childactivity.project}}</option>
                                        <option *ngFor = "let project of projectsList" [value]="project.id">{{project.name}}</option>
                                    </select>
                                </div>
                              </div>
                              <div class="col-lg-5 dashboard-activity-padding">
                                <div class="form-group">
                                  <input type="text" id="childactivity{{i}}{{k}}" class="form-control form-control-alternative black" (keyup.enter)="updateChild(children.date, childactivity.id,i,k)" placeholder="Activity" [value] = "childactivity.activity" >
                                </div>
                              </div>
                              <div class="col-lg-2 dashboard-activity-padding">
                                <div class="form-group">
                                  <input type="text" id="childhours{{i}}{{k}}" class="form-control form-control-alternative black" (keyup.enter)="updateChild(children.date, childactivity.id,i,k)" placeholder="Hours" [value] = "childactivity.hours">
                                </div>
                              </div>
                              <div id = "editbutton{{i}}{{k}}" style="display: block;">
                                <a (click) = "enableFieldsChild(i,k)" style="cursor: pointer;"><i class='fas fa-edit icon-style' style="color:  #33ccff"></i> </a>
                              </div>
                              <div id ="savebutton{{i}}{{k}}" style="display: none;">
                                <a (click)="updateChild(children.date, childactivity.id,i,k)" style="cursor:pointer ;"><i class='fas fa-check icon-style' style="color:  #40ff00"></i></a>
                              </div>
                              <div>
                                <a (click)="removeActivity(childactivity.id)" style="cursor:pointer ;"><i class='fas fa-trash icon-style' style="color:  #ff0000"></i></a>
                              </div>
                            </div>
                          </div>
                        </form>
                      </div>
                    </div>
                    <div class="">
                      <div class="card-body card-padding margin-fields" *ngFor = "let container of children.containers; let j = index">
                        <form class="form-height" [formGroup] = "childActivityForm">
                          <div class="dashboard-activity-margin">
                            <div class="row">
                              <div class="col-lg-3 dashboard-activity-padding">
                                <div class="form-group">
                                  <select id="project{{i}}{{j}}"class="project-dropdown" formControlName = "project" placeholder="Select Project">
                                      <option value="" disabled selected hidden>Select Project</option>
                                      <option *ngFor = "let project of projectsList" [value]="project.id">{{project.name}}</option>
                                  </select>                                </div>
                              </div>
                              <div class="col-lg-5 dashboard-activity-padding">
                                <div class="form-group">
                                  <input type="text" id="input-activity" class="form-control form-control-alternative" placeholder="Activity" style = "color: black;" value="" formControlName = "activity">
                                    </div>
                                </div>
                              <div class="col-lg-2 dashboard-activity-padding">
                                <div class="form-group">
                                  <input type="text" id="input-hours" class="form-control form-control-alternative" placeholder="Hours" style = "color: black;" value="" formControlName = "hours">
                                </div>
                              </div>
                              <div class="button-margin">
                                <button class="btn btn-success" (click) = "childActivityCreate(children.date)">Save</button>
                              </div>
                            </div>
                          </div>
                        </form>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- Chart wrapper -->
          </div>
        </div>
      </perfect-scrollbar>
    </div>
    <div class="col-xl-4" >
      <div class="card shadow" style="height: 700px;">
        <div class="card-header bg-transparent">
          <div class="row align-items-center">
            <div class="col">
              <h2 class="mb-0">What's New?</h2>
            </div>
          </div>
        </div>
        <div class="card-body scroll-hover">
          <!-- Chart -->
              <ol class="activity-feed">
                  <li class="feed-item" *ngFor= "let notification of Notificationslist; let i=index" [attr.data-content] = "getIcon(notification.notification_type)" [attr.data-time]="notification.created_at | dateAgo" [attr.data-color]="getColor(notification.notification_type)">
                    <section>
                      <input type="checkbox" id="expand_{{i+1}}" name="expand_{{i+1}}" (click)="open(mymodal, notification.project_id, notification.activity_name, notification.date, notification.notification_type)" />
                      <label for="expand_{{i+1}}" [style.color] = "notification.is_read == 0 ? 'black' : 'grey'">
                        {{notification.notification}}
                      </label>
                    </section>
                      <ng-template #mymodal let-modal>
                          <div class="modal-header">
                            <h4 class="modal-title" id="modal-basic-title">Create Activity</h4>
                              <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
                                <span aria-hidden="true">&times;</span>
                              </button>
                          </div>
                          <div class="modal-body">
                            <form>
                              <div class="row">
                                <div class="col-md-6">
                                  <div class="form-group">
                                    <div class="input-group mb-4">
                                      <div class="input-group-prepend">
                                        <span class="input-group-text"></span>
                                      </div>
                                      <input class="form-control text-color" name="dp" id="date" [(ngModel)]="notificationData.activity.date" ngbDatepicker #d="ngbDatepicker" (click)="d.toggle()" type="text" placeholder="Date">
                                    </div>
                                  </div>
                                </div>
                                <div class="col-md-6">
                                  <div class="form-group">
                                    <div class="input-group mb-4">
                                        <select class="project-dropdown" [(ngModel)]="notificationData.activity.project_id" name="project_id" id="projectid"> 
                                            <option *ngFor = "let project of projectsList" [value]="project.id">{{project.name}}</option> 
                                          </select>                                 
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <div class="row">
                                <div class="col-md-6">
                                  <div class="form-group">
                                    <input class="form-control text-color" placeholder="Activity" id="name" name ="name"  type="text" [(ngModel)]="notificationData.activity.name">
                                  </div>
                                </div>
                                <div class="col-md-6">
                                  <div class="form-group">
                                    <input class="form-control text-color" placeholder="Hours" id="hour" name="hours"  [(ngModel)]="notificationData.activity.hours" type="text">
                                  </div>
                                </div>
                              </div>
                            </form>
                          </div>
                          <div class="modal-footer">
                            <button type="button" class="btn btn-success" (click)="onCreate(notification.id)">Create</button>
                            <button type="button" class="btn btn-danger" id="cancel" (click)="modal.close('modal.dismiss')">Cancel</button>
                          </div>
                      </ng-template>
                  </li>
                </ol>
            </div>
      </div>
    </div>
  </div>
</div>
